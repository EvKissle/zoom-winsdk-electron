#pragma once
#include <windows.h>
#include "./h/zoom_sdk.h"
#include "./h/meeting_service_interface.h"
#include "./h/auth_service_interface.h"
typedef ZOOM_SDK_NAMESPACE::SDKError(*fnInitSDK)(ZOOM_SDK_NAMESPACE::InitParam& initParam);
typedef ZOOM_SDK_NAMESPACE::SDKError(*fnCreateMeetingService)(ZOOM_SDK_NAMESPACE::IMeetingService** ppMeetingService);
typedef ZOOM_SDK_NAMESPACE::SDKError(*fnDestroyMeetingService)(ZOOM_SDK_NAMESPACE::IMeetingService* pMeetingService);
typedef ZOOM_SDK_NAMESPACE::SDKError(*fnCreateAuthService)(ZOOM_SDK_NAMESPACE::IAuthService** ppAuthService);
typedef ZOOM_SDK_NAMESPACE::SDKError(*fnDestroyAuthService)(ZOOM_SDK_NAMESPACE::IAuthService* pAuthService);
typedef ZOOM_SDK_NAMESPACE::SDKError(*fnCreateSettingService)(ZOOM_SDK_NAMESPACE::ISettingService** ppSettingService);
typedef ZOOM_SDK_NAMESPACE::SDKError(*fnDestroySettingService)(ZOOM_SDK_NAMESPACE::ISettingService* pSettingService);
typedef ZOOM_SDK_NAMESPACE::SDKError(*fnCreateCalenderService)(ZOOM_SDK_NAMESPACE::ICalenderService** ppCalenderService);
typedef ZOOM_SDK_NAMESPACE::SDKError(*fnDestroyCalenderService)(ZOOM_SDK_NAMESPACE::ICalenderService* pCalenderService);
typedef ZOOM_SDK_NAMESPACE::SDKError(*fnCleanUPSDK)();
class CSDKImpl
{
public:
	virtual ~CSDKImpl();
	static CSDKImpl& GetInst();

	bool ConfigSDKModule(std::wstring& path);
	void Uninit();
	//
	virtual	ZOOM_SDK_NAMESPACE::SDKError InitSDK(ZOOM_SDK_NAMESPACE::InitParam& initParam);
	virtual ZOOM_SDK_NAMESPACE::SDKError CreateMeetingService(ZOOM_SDK_NAMESPACE::IMeetingService** ppMeetingService);
	virtual ZOOM_SDK_NAMESPACE::SDKError DestroyMeetingService(ZOOM_SDK_NAMESPACE::IMeetingService* pMeetingService);
	virtual ZOOM_SDK_NAMESPACE::SDKError CreateAuthService(ZOOM_SDK_NAMESPACE::IAuthService** ppAuthService);
	virtual ZOOM_SDK_NAMESPACE::SDKError DestroyAuthService(ZOOM_SDK_NAMESPACE::IAuthService* pAuthService);
	virtual ZOOM_SDK_NAMESPACE::SDKError CreateSettingService(ZOOM_SDK_NAMESPACE::ISettingService** ppSettingService);
	virtual ZOOM_SDK_NAMESPACE::SDKError DestroySettingService(ZOOM_SDK_NAMESPACE::ISettingService* pSettingService);
	virtual ZOOM_SDK_NAMESPACE::SDKError CreateCalenderService(ZOOM_SDK_NAMESPACE::ICalenderService** ppCalenderService);
	virtual ZOOM_SDK_NAMESPACE::SDKError DestroyCalenderService(ZOOM_SDK_NAMESPACE::ICalenderService* pCalenderService);
	virtual ZOOM_SDK_NAMESPACE::SDKError CleanUPSDK();

private:
	CSDKImpl();
	void Reset();
private:
	bool m_bInit;
	HMODULE m_hSdk;
	fnInitSDK m_fnInitSDK;
	fnCleanUPSDK m_fnCleanUPSDK;
	fnCreateMeetingService m_fnCreateMeetingService;
	fnDestroyMeetingService m_fnDestroyMeetingService;
	fnCreateAuthService m_fnCreateAuthService;
	fnDestroyAuthService m_fnDestroyAuthService;
	fnCreateSettingService m_fnCreateSettingService;
	fnDestroySettingService m_fnDestroySettingService;
	fnCreateCalenderService m_fnCreateCalenderService;
	fnDestroyCalenderService m_fnDestroyCalenderService;
};