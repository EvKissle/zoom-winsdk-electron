#ifndef _ANNOTATION_CTRL_WRAP_H_
#define _ANNOTATION_CTRL_WRAP_H_
#include <windows.h>
#include "./h/zoom_sdk.h"
#include "./h/meeting_service_interface.h"
//#include "./h/auth_service_interface.h"
#include <node.h>
#include <string>
#include <v8.h>
#include "sdk_impl.h"
#include "thread_routing.h"

class CAnnotationCtrlWrap
{
public:
	CAnnotationCtrlWrap();
	~CAnnotationCtrlWrap();
	void SetIAnnotationObj(ZOOM_SDK_NAMESPACE::IAnnotationController* pCtrl);
	virtual bool IsAnnoataionDisable();
	virtual ZOOM_SDK_NAMESPACE::SDKError StartAnnotation(ZOOM_SDK_NAMESPACE::SDKViewType viewtype, int left, int top);
	virtual ZOOM_SDK_NAMESPACE::SDKError StopAnnotation(ZOOM_SDK_NAMESPACE::SDKViewType viewtype);
	virtual ZOOM_SDK_NAMESPACE::SDKError SetTool(ZOOM_SDK_NAMESPACE::SDKViewType viewtype, ZOOM_SDK_NAMESPACE::AnnotationToolType type);
	virtual ZOOM_SDK_NAMESPACE::SDKError Clear(ZOOM_SDK_NAMESPACE::SDKViewType viewtype, ZOOM_SDK_NAMESPACE::AnnotationClearType type);
	virtual ZOOM_SDK_NAMESPACE::SDKError SetColor(ZOOM_SDK_NAMESPACE::SDKViewType viewtype, unsigned long color);
	virtual ZOOM_SDK_NAMESPACE::SDKError SetLineWidth(ZOOM_SDK_NAMESPACE::SDKViewType viewtype, long lineWidth);
	virtual ZOOM_SDK_NAMESPACE::SDKError Undo(ZOOM_SDK_NAMESPACE::SDKViewType viewtype);
	virtual ZOOM_SDK_NAMESPACE::SDKError Redo(ZOOM_SDK_NAMESPACE::SDKViewType viewtype);

private:
	bool IsAnnoataionDisableTask();
	ZOOM_SDK_NAMESPACE::SDKError StartAnnotationTask(ZOOM_SDK_NAMESPACE::SDKViewType viewtype, int left, int top);
	ZOOM_SDK_NAMESPACE::SDKError StopAnnotationTask(ZOOM_SDK_NAMESPACE::SDKViewType viewtype);
	ZOOM_SDK_NAMESPACE::SDKError SetToolTask(ZOOM_SDK_NAMESPACE::SDKViewType viewtype, ZOOM_SDK_NAMESPACE::AnnotationToolType type);
	ZOOM_SDK_NAMESPACE::SDKError ClearTask(ZOOM_SDK_NAMESPACE::SDKViewType viewtype, ZOOM_SDK_NAMESPACE::AnnotationClearType type);
	ZOOM_SDK_NAMESPACE::SDKError SetColorTask(ZOOM_SDK_NAMESPACE::SDKViewType viewtype, unsigned long color);
	ZOOM_SDK_NAMESPACE::SDKError SetLineWidthTask(ZOOM_SDK_NAMESPACE::SDKViewType viewtype, long lineWidth);
	ZOOM_SDK_NAMESPACE::SDKError UndoTask(ZOOM_SDK_NAMESPACE::SDKViewType viewtype);
	ZOOM_SDK_NAMESPACE::SDKError RedoTask(ZOOM_SDK_NAMESPACE::SDKViewType viewtype);

private:
	ZOOM_SDK_NAMESPACE::IAnnotationController* m_pRealAnnotationCtrl;
};
#endif